# NOTE: This CIS Profile only includes Level 1 Scored Items for Amazon Linux*
# NOTE: Within this file, there are a few sections that should be tailored to your
#       organization's specific policy.  Search for '# NOTE: ' comments through the file.

# TODO: Checks that aren't implemented yet:
#       3.6.5
#       4.2.4
#       6.2.6-19



grep:
  blacklist:
    legacy_passwd_entries_group:
      data:
        'Amazon Linux*':
        - /etc/group:
            pattern: '^+:'
            tag: CIS-6.2.4
      description: Ensure no legacy "+" entries exist in /etc/group
  whitelist:
    activate_gpg_check:
      data:
        'Amazon Linux*':
        - /etc/yum.conf:
            match_output: gpgcheck=1
            pattern: gpgcheck
            tag: CIS-1.2.3
      description: Ensure gpgcheck is globally activated
pkg:
  blacklist:
    avahi-daemon:
      data:
        'Amazon Linux*':
        - avahi-daemon: CIS-2.2.3
      description: Ensure Avahi Server is not enabled
  whitelist:
    aide:
      data:
        'Amazon Linux*':
        - aide: CIS-1.3.1
      description: Ensure AIDE is installed
service:
  blacklist:
    autofs:
      data:
        'Amazon Linux*':
        - autofs: CIS-1.1.19
      description: Disable Automounting
  whitelist:
    crond_running:
      data:
        'Amazon Linux*':
        - crond: CIS-5.1.1
      description: Ensure cron daemon is enabled
